import{i as v,j as y}from"./chunk-E6LAGS3E.js";import{h as n}from"./chunk-P7ST6TYJ.js";var b={initialListState:"hidden"};function m(u){return u?u.trim().toLowerCase().replace(/\s+/g,"-"):""}function g(u){let e=window.getComputedStyle(u);return e?e.display==="none"?"block":e.display:"block"}var h={fadeIn:1,expand:1.1,fadeOut:.7,collapse:.85,delayStep:.1,maxDelay:.5,listReveal:1.2},T=".project-div",S=".project-image, .project-video, .grid-image, .grid-video, .video-item, .video-item-prj",A=".description-div",w=".categories [data-filter-value], .categories .text-size-small, .project-services .text-size-small, .services-list-wrapper .text-size-small, .service-text .text-size-small, [data-filter-category], [data-filter-slug], [data-filter-value], [data-capability], [data-category]",E=v.distance*1.1,f=class{constructor(e,t={}){this.listWrapper=null;this.triggerMap=new Map;this.triggerHandlers=new Map;this.cards=new Map;this.activeFilter="all";this.observer=null;this.refreshTimeout=null;this.hasRevealedList=!1;this.initialFilterApplied=!1;this.popStateHandler=()=>{this.applyFilter(this.getFilterFromUrl(),{animate:!0,updateUrl:!1,force:!0})};var r,s,a;this.options={...b,...t},this.container=e instanceof Document?e.documentElement:e;let i=e instanceof Document?e:e.ownerDocument;this.nav=i==null?void 0:i.querySelector(".projects-nav"),e instanceof Element?this.listWrapper=(r=e.querySelector(".project-list-wrapper"))!=null?r:e.querySelector(".project-list"):this.listWrapper=(a=(s=i==null?void 0:i.querySelector(".project-list-wrapper"))!=null?s:i==null?void 0:i.querySelector(".project-list"))!=null?a:null}init(){this.hideListWrapper(),this.collectTriggers(),this.collectCards(),this.observeMutations(),window.addEventListener("popstate",this.popStateHandler);let e=this.getFilterFromUrl();this.applyFilter(e,{animate:!1,updateUrl:!0,pushState:!1,force:!0})}destroy(){this.triggerHandlers.forEach((e,t)=>{t.removeEventListener("click",e)}),this.triggerHandlers.clear(),this.triggerMap.clear(),this.cards.forEach(e=>{var t;(t=e.timeline)==null||t.kill(),e.timeline=void 0}),this.cards.clear(),this.observer&&(this.observer.disconnect(),this.observer=null),this.refreshTimeout!==null&&(window.clearTimeout(this.refreshTimeout),this.refreshTimeout=null),window.removeEventListener("popstate",this.popStateHandler),this.hasRevealedList=!1,this.initialFilterApplied=!1}applyExternalFilter(e,t={}){this.applyFilter(e,t)}hideListWrapper(){var t;if(!this.listWrapper){this.hasRevealedList=!1,this.initialFilterApplied=!1;return}let e=(t=this.listWrapper.querySelector("[data-filter-empty]"))!=null?t:this.listWrapper.querySelector(".w-dyn-empty");if(this.options.initialListState==="visible"){n.set(this.listWrapper,{autoAlpha:1,pointerEvents:"auto",visibility:"visible"}),e&&n.set(e,{autoAlpha:0,display:"none",pointerEvents:"none"}),this.hasRevealedList=!0,this.initialFilterApplied=!1;return}n.set(this.listWrapper,{autoAlpha:0,pointerEvents:"none"}),e&&n.set(e,{autoAlpha:0,display:"none",pointerEvents:"none"}),this.hasRevealedList=!1,this.initialFilterApplied=!1}maybeRevealList(e){if(!this.listWrapper||this.hasRevealedList)return;let t=Array.from(this.cards.values()).some(s=>s.isVisible),i=this.listWrapper.querySelector(".w-dyn-empty");if(!t&&!i)return;this.hasRevealedList=!0,e||!this.initialFilterApplied?n.to(this.listWrapper,{autoAlpha:1,duration:h.listReveal,ease:"power2.out",pointerEvents:"auto"}):n.set(this.listWrapper,{autoAlpha:1,pointerEvents:"auto"})}readElementMetrics(e){let{element:t,defaultDisplay:i}=e,r=t.getAttribute("style"),s=r!==null,a=window.getComputedStyle(t),l=a.display==="none"||t.offsetHeight===0||Number.isNaN(t.offsetHeight);if(l){t.style.position="absolute",t.style.visibility="hidden",t.style.pointerEvents="none",t.style.display=i||"block";let{width:p}=a;p&&p!=="auto"&&(t.style.width=p),t.style.height="",t.style.marginTop="",t.style.marginBottom="",t.style.paddingTop="",t.style.paddingBottom=""}let o=window.getComputedStyle(t),c={height:t.offsetHeight,marginTop:parseFloat(o.marginTop)||0,marginBottom:parseFloat(o.marginBottom)||0,paddingTop:parseFloat(o.paddingTop)||0,paddingBottom:parseFloat(o.paddingBottom)||0};return l&&(s?t.setAttribute("style",r):t.removeAttribute("style")),c}measureCard(e,t=!1){if(!t&&e.metrics)return e.metrics;let i=this.readElementMetrics(e);return e.metrics=i,i}getCardDescription(e){return e.element.querySelector(A)}getCardMediaElements(e){return Array.from(e.element.querySelectorAll(S))}restoreCardVisibility(e,t,i){let r=[e.element];t||(t=this.getCardDescription(e)),(!i||!i.length)&&(i=this.getCardMediaElements(e)),t&&r.push(t),i&&i.length&&r.push(...i),r.forEach(s=>{s&&(s.style.opacity&&s.style.opacity!=="1"&&(s.style.opacity="1"),s.style.visibility&&s.style.visibility!=="visible"&&(s.style.visibility="visible"),s.style.removeProperty("translate"),s.style.removeProperty("rotate"),s.style.removeProperty("scale"),s.style.removeProperty("transform"))})}toggleEmptyState(e){var r;if(!this.listWrapper)return;let t=(r=this.listWrapper.querySelector("[data-filter-empty]"))!=null?r:this.listWrapper.querySelector(".w-dyn-empty");if(!t)return;let i=g(t);n.killTweensOf(t),e?(n.set(t,{display:i,pointerEvents:"auto"}),n.to(t,{autoAlpha:1,duration:.45,ease:"power2.out"})):n.to(t,{autoAlpha:0,duration:.3,ease:"power2.out",pointerEvents:"none",onComplete:()=>{t.style.display="none"}})}collectTriggers(){if(!this.nav)return;let e=Array.from(this.nav.querySelectorAll("[data-filter-trigger]"));if(e.forEach(t=>{var s,a;let i=m((a=(s=t.dataset.filterTrigger)!=null?s:t.getAttribute("href"))!=null?a:"");if(!i)return;this.triggerMap.set(i,t);let r=l=>{l.preventDefault(),this.applyFilter(i,{animate:!0,updateUrl:!0,pushState:!0})};t.addEventListener("click",r),this.triggerHandlers.set(t,r)}),!this.triggerMap.has("all")){let t=e.find(i=>{var s;return m((s=i.dataset.filterTrigger)!=null?s:"")==="all"});t&&this.triggerMap.set("all",t)}}collectCards(){let e=Array.from(this.container.querySelectorAll(T)),t=new Map;e.forEach(i=>{let r=this.cards.get(i),s=this.extractCategories(i);if(r){r.categories=s,this.measureCard(r,!0),t.set(i,r);return}let a={element:i,categories:s,defaultDisplay:g(i),isVisible:!0};this.measureCard(a,!0),t.set(i,a)}),this.cards.forEach((i,r)=>{var s;t.has(r)||(s=i.timeline)==null||s.kill()}),this.cards=t}extractCategories(e){let t=new Set,i=l=>{l&&l.split(/[,/|]+/).map(o=>m(o)).filter(Boolean).forEach(o=>t.add(o))};return["data-filter-slug","data-filter-category","data-category","data-categories","data-capability","data-filter-value","data-category-slugs"].forEach(l=>{i(e.getAttribute(l))}),["filterSlug","filterCategory","category","categories","capability","filterValue"].forEach(l=>{l in e.dataset&&i(e.dataset[l])}),Array.from(e.querySelectorAll(w)).filter(l=>l.childElementCount===0).forEach(l=>{i(l.textContent)}),t}observeMutations(){let e=this.container.querySelector(".project-list"),t=e!=null?e:this.container;this.observer=new MutationObserver(i=>{i.some(r=>r.type==="childList")&&this.scheduleRefresh()}),this.observer.observe(t,{childList:!0,subtree:!0})}scheduleRefresh(){this.refreshTimeout!==null&&window.clearTimeout(this.refreshTimeout),this.refreshTimeout=window.setTimeout(()=>{this.refreshTimeout=null,this.collectCards(),this.applyFilter(this.activeFilter,{animate:!1,updateUrl:!1,force:!0})},50)}getFilterFromUrl(){var r,s;let e=new URL(window.location.href),t=m((s=(r=e.searchParams.get("category"))!=null?r:e.searchParams.get("capability"))!=null?s:"");if(t)return t;let i=e.hash.replace("#","");if(!i)return"all";if(i.includes("=")){let[a,l]=i.split("=");if(a==="category"||a==="capability")return m(l)}return m(i)||"all"}applyFilter(e,t={}){let{animate:i=!0,updateUrl:r=!1,pushState:s=!1,force:a=!1}=t,l=m(e);if(l||(l="all"),l!=="all"&&!this.triggerMap.has(l)&&(l="all"),!a&&l===this.activeFilter){r&&this.updateUrl(l,s);return}this.activeFilter=l,this.updateTriggers(l),this.filterCards(l,i),this.maybeRevealList(!this.hasRevealedList),this.initialFilterApplied=!0,y(this.container),r&&this.updateUrl(l,s)}updateTriggers(e){this.triggerMap.forEach((t,i)=>{let r=i===e||e==="all"&&i==="all";t.classList.toggle("is-active",r),t.classList.toggle("w--current",r),r?(t.setAttribute("aria-current","true"),t.setAttribute("aria-pressed","true")):(t.removeAttribute("aria-current"),t.setAttribute("aria-pressed","false"))})}filterCards(e,t){let i=e==="all",r=Array.from(this.cards.values()),s=0,a=0;r.forEach(l=>{i||l.categories.has(e)?(this.showCard(l,t,s),s+=1,a+=1):this.hideCard(l,t)}),this.toggleEmptyState(a===0)}showCard(e,t,i){var c;(c=e.timeline)==null||c.kill(),e.timeline=void 0;let r=this.getCardMediaElements(e),s=this.getCardDescription(e);if(this.restoreCardVisibility(e,s,r),e.isVisible){n.set(e.element,{display:e.defaultDisplay,autoAlpha:1,y:0,pointerEvents:"auto",overflow:"",height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:""}),s&&n.set(s,{autoAlpha:1,y:0,pointerEvents:"auto"}),r.length&&n.set(r,{autoAlpha:1,y:0,pointerEvents:"auto"}),this.restoreCardVisibility(e,s,r);return}let a=this.measureCard(e,!0),l=Math.min(i*h.delayStep,h.maxDelay),o=E;if(e.isVisible=!0,t){let p=n.timeline({defaults:{overwrite:"auto"},onComplete:()=>{e.timeline===p&&(e.timeline=void 0),n.set(e.element,{overflow:"",height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:"",pointerEvents:"auto",visibility:"visible"}),s&&n.set(s,{pointerEvents:"auto"}),r.length&&n.set(r,{pointerEvents:"auto"}),this.restoreCardVisibility(e,s,r),this.measureCard(e,!0)}});p.set(e.element,{display:e.defaultDisplay,autoAlpha:0,height:0,marginTop:0,marginBottom:0,paddingTop:0,paddingBottom:0,y:o,overflow:"hidden",pointerEvents:"none",visibility:"hidden"}),s&&p.set(s,{autoAlpha:0,y:o*.65,pointerEvents:"none",visibility:"hidden"},0),r.length&&p.set(r,{autoAlpha:0,pointerEvents:"none",visibility:"hidden"},0),p.to(e.element,{height:a.height,marginTop:a.marginTop,marginBottom:a.marginBottom,paddingTop:a.paddingTop,paddingBottom:a.paddingBottom,duration:h.expand,ease:"power2.inOut",delay:l},0),p.to(e.element,{autoAlpha:1,y:0,pointerEvents:"auto",visibility:"visible",duration:h.fadeIn,ease:"power2.out"},l+.12),s&&p.to(s,{autoAlpha:1,y:0,pointerEvents:"auto",visibility:"visible",duration:.55,ease:"power2.out"},l+.18),r.length&&p.to(r,{autoAlpha:1,pointerEvents:"auto",visibility:"visible",duration:.6,stagger:.04,ease:"power2.out"},l+.24),e.timeline=p}else n.set(e.element,{display:e.defaultDisplay,autoAlpha:1,y:0,pointerEvents:"auto",overflow:"",height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:"",visibility:"visible"}),s&&n.set(s,{autoAlpha:1,y:0,pointerEvents:"auto",visibility:"visible"}),r.length&&n.set(r,{autoAlpha:1,pointerEvents:"auto",visibility:"visible"}),this.restoreCardVisibility(e,s,r),this.measureCard(e,!0)}hideCard(e,t){var a;if(!e.isVisible&&!e.timeline)return;(a=e.timeline)==null||a.kill(),e.timeline=void 0,this.measureCard(e,!0),e.isVisible=!1;let i=this.getCardDescription(e),r=this.getCardMediaElements(e),s=E;if(t){let l=n.timeline({defaults:{overwrite:"auto"},onComplete:()=>{e.timeline===l&&(e.timeline=void 0),n.set(e.element,{display:"none",pointerEvents:"none",autoAlpha:0,y:0,height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:"",overflow:"",visibility:"hidden"}),i&&n.set(i,{autoAlpha:0,y:0,pointerEvents:"none",visibility:"hidden"}),r.length&&n.set(r,{autoAlpha:0,pointerEvents:"none",visibility:"hidden"})}});if(l.set(e.element,{overflow:"hidden",pointerEvents:"none",visibility:"visible"}),r.length){let o=r.slice().reverse();l.to(o,{autoAlpha:0,duration:Math.max(.45,h.fadeOut*.75),ease:"power2.inOut",stagger:.04},0)}i&&l.to(i,{autoAlpha:0,y:-s*.6,duration:Math.max(.4,h.fadeOut*.7),ease:"power2.inOut"},.06),l.to(e.element,{autoAlpha:0,y:-s,height:0,marginTop:0,marginBottom:0,paddingTop:0,paddingBottom:0,duration:h.collapse,ease:"power2.inOut"},0),e.timeline=l}else n.set(e.element,{autoAlpha:0,y:0,display:"none",pointerEvents:"none",height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:"",overflow:"",visibility:"hidden"}),i&&n.set(i,{autoAlpha:0,y:0,pointerEvents:"none",visibility:"hidden"}),r.length&&n.set(r,{autoAlpha:0,y:0,pointerEvents:"none",visibility:"hidden"})}updateUrl(e,t){let i=new URL(window.location.href);e==="all"?(i.searchParams.delete("category"),i.searchParams.delete("capability")):i.searchParams.set("category",e);let r=`${i.pathname}${i.search}${i.hash}`;t?window.history.pushState({filter:e},"",r):window.history.replaceState({filter:e},"",r)}},d=null;function H(u=document,e){C(),d=new f(u,e),d.init()}function C(){d==null||d.destroy(),d=null}function P(u,e){d==null||d.applyExternalFilter(u,e)}export{P as applyProjectFilter,C as destroyProjectFilters,H as initProjectFilters};
